---
title: 모든 세자리 수를 만드는 분수
date: 2023-10-24
tags:
  - 수열
  - 결과
  - 자리
  - 반복
  - 급수
  - 피보나치
  - 생성함수
---
	## 특별한 배열을 만드는 분수들
$\frac{1}{998001}$은 소수로 나타내면 매우 특별한 결과를 가집니다. 소수점 아래에는 $000$부터 $999$까지의 모든 세자리 수를 나열하는데 하필 $998$만 누락됩니다. 심지어 이 결괏값은 계속 반복되는 순환소수죠.[^1]

$$
\begin{align*}
\frac{1}{998001} = 0.&000\,001\,002\,003\,004\, \cdots\,995\,996\,997\,999 \\
&000\,001\,002\,003\,004\, \cdots\,995\,996\,997\,999\cdots
\end{align*}
$$

여기서 주목해야 할 점은, $998001 = 999^2$이라는 사실입니다. 같은 패턴을 따라, $\frac{1}{9^2}$과 $\frac{1}{99^2}$을 살펴보면 

$$
\begin{gather*}
\frac{1}{9^2} = 0.0\,1\,2\,3\,4\,5\,6\,7\,9\cdots\\
\frac{1}{99^2} = 0.00\,01\,02\,03\,04\ \cdots95\,96\,97\,99\cdots\\
\frac{1}{999^2} = 0.000\,001\,002\,003\,004\, \cdots\,995\,996\,997\,999\cdots\\
\end{gather*}
$$

$\frac{1}{9^2}$의 경우 $8$을 제외한 모든 한자리 숫자를 반복해서 생성하고, $\frac{1}{99^2}$의 경우 $98$을 제외한 모든 두자리 숫자를 반복하여 생성합니다. 왜 이러한 현상이 일어날까요? 

우선 나눗셈을 통해 결과를 관찰해보겠습니다. 나눗셈을 하면 소수점 아래에서 규칙적으로 숫자가 유지되다가 $9$에서 $1$을 뺀 수에서는 더 이상 자리수가 부족해지지 않게 됩니다. 그러므로 바로 다음 수인 $9$가 나오게되죠. 이 다음부터는 다시 $1$이 생기게 되면서 앞선 배열이 반복되는 것을 알 수 있습니다.[^2]

$$
\begin{array}{c|ccccccccccccc}
&0&.&0&1&2&3&4&5&6&7&9&0&\cdots \newline
\hline
9^2&1&.&0&0&0&0&0&0&0&0&0&0&\cdots \\
&&&8&1&&&&&&&& \\
\hline
&&&1&9&0&&&&&&&& \\
&&&1&6&2&&&&&&&& \\
\hline
&&&&2&8&0&&&&&&& \\
&&&&2&4&3&&&&&&& \\
\hline
&&&&&3&7&0&&&&&& \\
&&&&&3&2&4&&&&&& \\
\hline
&&&&&&4&6&0&&&&& \\
&&&&&&4&0&5&&&&& \\
\hline
&&&&&&&5&5&0&&&& \\
&&&&&&&4&8&6&&&& \\
\hline
&&&&&&&&6&4&0&&& \\
&&&&&&&&5&6&7&&& \\
\hline
&&&&&&&&&7&3&0&& \\
&&&&&&&&&7&2&9&& \\
\hline
&&&&&&&&&&&1&0&\cdots \\
\end{array}
$$

 왜 인지는 모르겠지만 $1$이 더해지고 빼지는 과정에 무엇인가 있는 것 처럼 보이죠.

$$ 9^2 - 1^2 + 1= (9+1)(9-1) + 1 = 80 + 1$$

결과를 미리 알고 본다면 순환하는 무한소수를 만드는 방법을 이용하여 조금 더 쉽게 같은 결과를 얻어낼 수 있습니다.

$0.012345679$를 $s$라 두면 $s$에 $1000000000$(십억)을 곱한 수와 $s$를 빼면 다음과 같습니다. 

$$
\begin{align*}
1000000000s - s &= 999999999s\\
&= 12345679
\end{align*}
$$

$s$의 계수는 각 자리수가 $9$이고 아홉자리 이므로, $9^2$으로 소인수분해할 수 있습니다. 이때, 
$$
9^2 \times1234579=999999999
$$
이므로, 결과적으로

$$
s=\frac{1}{9^2}
$$
이 된다는 것을 알 수 있습니다. 

## 피보나치 수열을 생성하는 신기한 분수
반대로 $8$을 이용하여 새로운 수열을 찾는 방법도 있습니다. 예를들어 $\frac{1}{9899}$을 보겠습니다. 

$$
\begin{align*}
\frac{1}{9899} = 0.00 \,01\,01\,02\,03\,05\,08\,13\,21\,34\,55\,9046\cdots
\end{align*}
$$

이 수의 소수 부분을 보면 두 자리 마다 반복하며 $55$까지의 피보나치 수열을 만드는 것을 볼 수 있습니다. 이 규칙에 따라 가운데 $8$을 적고 $8$앞에는 $9$를 두 번, 뒤에는 세 번 적은 수로 $1$을 나누어 보면 세 자리 마다 반복하며 $988$까지의 피보나치 수열을 만들게 됩니다. 

$$
\begin{align*}
\frac{1}{998999} = 0.000\,001\,001\,002\,003\,005\,008\,013\,021\,034\,055\,089\,144\,233\,377\,610\,988\,5995\cdots
\end{align*}
$$

이러한 규칙은 더 큰 수로 나눈다면 더 정확한 값을 찾을 수 있습니다. 

$$
\begin{align*}
1/999,998,999,999 = 0.& 000000 \, 000001 \, 000001\,000002\,000003\, \\
&000005\,000008\, 000013\,000021\,000034\\
&000055\,000089\,000144\,000233\,000377\\
&000610\,000987\,001597\,002584\,004181\\
&006765\,010946\,017711\,028657\,046368\\
&075025\,121393\,196418\,317811\,514229\,832041 \cdots
\end{align*}
$$

그렇다면 이러한 현상은 단지 우연으로 숫자를 잘 찾은 것 뿐일까요?


## 생성함수
생성함수는 수열을 표현하는 간단하고도 강력한 도구입니다. 복잡한 수열이나 급수를 단순한 함수 형태로 나타내는 방법으로 수열의 일반항을 찾거나, 수열 간의 관계를 파악하는 것이 더 쉬워집니다.

예를들어 다음과 같이 피보나치 수열을 계수로 하는 다항식이 있다고 해보겠습니다.

$$
1+z+2z^2+3z^3+5z^4+8z^5+... = \sum_{n=0}^\infty F_nz^n
$$

피보나치 수열의 처음 두 항은 $1$이며$F_0 = F_1 = 1$ 그 뒤의 모든 항은 바로 앞 두 항의 합인 수열$F_{n+2} = F_n + F_{n+1}$입니다. 따라서 이 다항식에서 보면 피보나치 수열의 $n$항일때, 차수가 $n$이므로 항이 커질때마다 차수가 커지는 것을 알 수 있습니다. 이 성질들을 이용하여 식을 정리하기 위해 $(1 - z - z^2)$을 $\sum_{n=0}^\infty F_n z^n$에 곱해보겠습니다.

$$
\begin{align*}
(1-z-z^2)\sum_{n=0}^\infty F_nz^n &= \sum_{n=0}^\infty F_nz^n - \sum_{n=0}^\infty F_nz^{n+1} - \sum_{n=0}^\infty F_nz^{n+2} \\
&= \sum_{n=0}^\infty F_nz^n - \sum_{n=1}^\infty F_{n-1}z^n-\sum_{n=2}^\infty F_{n-2}z^n \\
&= F_0 + (F_1-F_0)z + \sum_{n=2}^\infty (F_n-F_{n-1}-F_{n-2})z^n
\end{align*}
$$

양 변에 $(1 - z - z^2)$을 곱한 후 급수의 변수를 조정하면 식을 비교적 간단하게 작성할 수 있습니다. 이 때,  $F_1 = F_0$이고 $F_n = F_{n-1} + F_{n-2}$이므로 결과적으로 피보나치 수열을 이용한 급수를 간단한 유리함수로 표현할 수 있습니다.

$$
\begin{align*}
(1-z-z^2)\sum_{n=0}^\infty F_nz^n &= F_{0 = 1}\\
\sum_{n=0}^\infty F_nz^n &= \frac{1}{1-z-z^2}
\end{align*}
$$

이런 식으로 수학은 복잡한 문제를 단순화시켜 우리에게 새로운 시각을 제공합니다. 이 분수의 성질을 보기 위해 $z = 10^{-2}$을 대입해보겠습니다.  

$$
\frac{1}{1 - 10^{-2} - 10^{-4}} = F_0 + 10^{-2}F_1 + 10^{-4}F_2 +\cdots\\
$$

그 후 좌변을 간단하게 바꾸기 위해 분자와 분모에 $10^4$를 곱하면, 다음과 같습니다.

$$
\frac{10^4}{10^4 - 10^2 - 1} = \frac{10^4}{9899}
$$

여기서 분모에 나타나는 $9899$가 바로 우리가 처음 보았던 분모와 일치합니다. 따라서 앞선 결과에서 소수점 아래에 피보나치 수열의 일반항이 나오는 것을 깔끔하게 구해낼 수 있죠.
$$
\begin{align*}
\frac{1}{9899} &= \frac{0}{10^2} + \frac{F_0}{10^4}+\frac{F_1}{10^6}+\frac{F_2}{10^{8}+\cdots}\\
&=0+0.0001+0.000001+0.00000002 + \cdots \\
&= 0.00 \,01\,01\,02\,03\,05\,08\,13\,21\,34\,55\,9046\cdots
\end{align*}
$$

## 테일러 전개와 생성함수
앞선 결과들을 보면 하나, 둘, 셀 수 있는 이산적인 수열임에도 불구하고 함수와 같이 연속적인 양과 관련이 있어보입니다. 심지어 이러한 급수표현의 함수를 우리는 테일러 급수에서 너무나 자주 볼 수 있었죠. 그래서 이러한 테일러 전개로 생성함수를 찾을 수는 없을까요? 다시 처음에 보았던 분수를 보도록 하겠습니다.

$\frac{1}{9^2}$. $\frac{1}{99^2}$, $\frac{1}{999^2}$ 모두, $10$의 거듭제곱에서 $1$을 뺀 수를 제곱한 후 역수를 취한 형태를 가집니다. 따라서 $10$을 변수로 바꿔 함수로 표현하면 $\frac{1}{(1-z^n)^2}$이라 나타낼 수 있습니다. 우선 간단하게 $n=1$일 때의 생성 함수를 보겠습니다. 

$$
\begin{gather*}
z = 10\\
\\
\frac{1}{9^2} = \frac{1}{\left(1-10 \right)^2}=\frac{1}{(1-z)^2}\\
\frac{1}{99^2} = \frac{1}{ \left(1-10^2\right)^2}=\frac{1}{(1-z^2)^2}\\
\frac{1}{999^2} = \frac{1}{ \left(1-10^3\right)^2}=\frac{1}{(1-z^3)^2}\\
\\
\vdots\\
\\
\frac{1}{(1-z^n)^2}
\end{gather*}
$$


테일러 급수는 $x=a$ 주변에서 함수를 다항식으로 근사함으로써 원하는 위치에서 함수의 값을 예측하는 데 사용됩니다. 이러한 다항식은 $x=a$에 가까워질수록 원래 함수와 비슷한 값을 가지게 됩니다.

$$
f(x) = \sum_{n=0}^{\infty} \frac{f^{(n)}(a)}{n!}(x-a)^n
$$

$\frac{1}{(1-z)^2}$를 $n$번 미분한 결과는 다음과 같은 패턴을 가집니다.

$$
\frac{d^n}{dz^n} \left( \frac{1}{(1-z)^2} \right) = \frac{(n+1)!}{(1-z)^{n+2}}
$$

이제 이 미분한 결과에 $z=0$을 대입한 후, 

$$
\left. \frac{(n+1)!}{(1-z)^{n+2}} \right|_{z=0} = (n+1)!
$$

마지막으로 이 값을 $n!$으로 나누어 계수를 구할 수 있습니다.

$$
a_n = \frac{(n+1)!}{n!} = n+1
$$

따라서 생성 함수  $\frac{1}{(1-z)^2}$의 테일러 급수는 다음과 같습니다.

$$
\frac{1}{(1-z)^2} = \sum_{n=0}^{\infty} (n+1)z^n
$$

이제 이 식에 $z=\frac{1}{10}$을 대입해 전개해보겠습니다.

$$
\frac{1}{\left(1-\frac{1}{10} \right)^2} = \sum_{n=0}^{\infty} (n+1) \left(\frac{1}{10} \right)^n
$$

좌변에서는 우리가 찾고자했던 분모가 나오고 우변은 규칙적으로 분수의 덧셈이 있는 형태로 정리가 됩니다.

$$
\frac{10^2}{9^2} = 1 + \frac{2}{10} + \frac{3}{10^2} + \frac{4}{10^3} + \cdots
$$

정확한 값을 계산하기 위해 양변을 $10^2$으로 나누어 주면 $\frac{1}{9^2}$을 다음과 같이 급수의 합으로 나타낼 수 있습니다. 이 급수의 규칙성을 보면 분자는 $1$씩 커지며 분모의 차수는 분자보다 $1$ 큰 수라는 것을 어렵지 않게 확인할 수 있습니다. 소수 배열의 특징을 관찰하기 위해 우변을 소수로 표현해 결과를 보겠습니다.

$$
\frac{1}{9^2} = \frac{1}{10^2} + \frac{2}{10^3} + \frac{3}{10^4} + \frac{4}{10^5} + \cdots
$$

 앞서 본 규칙과 같이 소수들로 표현하면 소수점 아래 마지막 수는 $1$부터 $1$씩 커지는 수가 나오면서 그 수만큼 앞에 $0$이 붙게 됩니다. $0$ 이 너무 많아 눈이 아프지만 소수 표현을 조금 더 자세히 더해보도록 하겠습니다. 급수의 합은 소수들의 합으로도 나타낼 수 있으므로 

$$
\begin{align*}
\frac{1}{10^2} &= 0.01\\
\frac{2}{10^3} &= 0.002\\
\frac{3}{10^4} &= 0.0003\\
\frac{4}{10^5} &= 0.00004\\
\frac{5}{10^6} &= 0.000005\\
&\vdots\\
\end{align*}
$$

 다음과 같이 세로로 더해보도록 하겠습니다. 세로로 더하는 과정을 보면 $1$부터 $7$까지는 더해지는 값이 없으므로 그대로 나오는 반면 $10$번째 항에서는 자리수가 올라가며 앞선 $9$와 더해지게 됩니다. 이 과정에서 $9$가 $10$이 되므로 다시 자리수가 올라가서 $8$이 $9$로 바뀌게 됩니다. 이후엔 다시 앞선 결과가 반복되게 되죠.  

$$
\begin{array}{ccccccccccccccc} 
& 0 & . & 0 & 1 &  &  &  &  &  &  &  &  &  &  \\
& 0 & . & 0 & 0 & 2 &  &  &  &  &  &  &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 3 &  &  &  &  &  &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 4 &  &  &  &  &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 5 &  &  &  &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 0 & 6 &  &  &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 7 &  &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 8 &  &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 9 &  &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 0 &  \\ 
& 0 & . & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 0 & 1 & 1 \\
+&&&&&&&&\vdots&&&&&& \\ 
\hline 
& 0 & . & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 9 & 0 & 1 & \cdots \\
\end{array}
$$

이렇게 $\frac{1}{9^2}$이 $0$부터 $9$까지의 수 중 $8$을 제외하며 반복되는 이유를 설명할 수 있으며 같은 방법으로 $\frac{1}{99^2}$이나 $\frac{1}{999^2}$도 설명할 수 있습니다. 수학은 언제나 우리에게 새로운 놀라움을 선사합니다. 여러분들이 어떤 특정한 숫자배열이 필요하실 때 이러한 성질을 이용해보시는 것은 어떨까요?

## 다른 배열들
$9^2$인 $81$로 $1$을 나누면 소수점 아래 수들은 $0$부터 $9$까지의 $8$을 제외한 모든 자연수를 출력합니다.
같은 방법으로 $99^2$으로 $1$을 나누면 소수점 아래 수들은 $0$부터 $99$까지의 $98$을 제외한 모든 자연수를 순서대로 출력하고
$999^2$으로 $1$을 나누면 소수점 아래 수들은 $0$부터 $999$까지의 수 중 $998$만 제외하고 모든 자연수가 나오죠.

그리고 이 배열은 계속 순환하는데요. 이는 우연일까요?

$$
\begin{align*}
\frac{1}{9899} = 0.&00 \,01\,01\,02\,03\,05\\
&08\,13\,21\,34\,55\,9046\cdots
\end{align*}
$$

소수 부분을 보면 두 자리 마다 반복하며 $55$까지의 피보나치 수열을 만드는 것을 볼 수 있습니다. 비슷하게 가운데 $8$을 적고 $8$앞에는 $9$를 두 번, 뒤에는 세 번 적은 수로 $1$을 나누어 보면 세 자리 마다 반복하며 $988$까지의 피보나치 수열을 만들게 됩니다. 

$$
\begin{align*}
1/998999 = 0.&\,000\,001\,001\,002\,003\\
&\, 005 \,008\,013\,021\,034\\
&\,055\,089 \,144\,233\,377\\
&\,610\,988\,5995\cdots
\end{align*}
$$

이러한 규칙은 더 큰 수로 나눈다면 더 정확한 값을 찾을 수 있는데요.

$$
\begin{align*}
1/999,998,999,999 =
&&0.000000 \, 000001 \, 000001\,000002\,\\
&&000003\,000005\,000008\, 000013\,\\
&&000021\,000034\,000055\,000089\,\\
&&000144\,000233\,000377\,000610\,\\
&&000987\,001597\,002584\,004181\,\\
&&006765\,010946\,017711\,028657\,\\
&&046368\,075025\,121393\,196418\,\\
&&317811\,514229\,832041 \cdots
\end{align*}
$$

이러한 현상은 단지 우연으로 숫자를 잘 찾은 것 뿐일까요?

[^1]: [up to 1000 decimal of 1/998801](https://wolfreealpha.gitlab.io/input/?i=up+to+1000+decimal+of+1%2F998801)
[^2]: [1/81의 결과](https://wolfreealpha.gitlab.io/input/?i=1%2F9%5E2)